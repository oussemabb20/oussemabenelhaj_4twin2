import './polyfills.server.mjs';
import{a as D,b as s,c as q,d as B,f as G,h as L,i as R,j as A,k as z,l as H,o as j,q as U}from"./chunk-XIT27GUT.mjs";import{a as V,b as k,f as T}from"./chunk-B24YV5OD.mjs";import{$ as m,N as o,Na as y,Oa as E,Qa as N,T as d,V as l,X as p,Z as n,_ as t,ca as M,da as O,ea as _,fa as i,fb as F,ga as u,ib as I,jb as w,m as c,na as P,o as x,t as C,u as b,v as g,w as v}from"./chunk-ALOC2SIV.mjs";import{a as h,b as S}from"./chunk-5XUXGTUW.mjs";function K(r,a){r&1&&m(0,"app-loading-spinner")}function Q(r,a){r&1&&(n(0,"small"),i(1,"Required"),t())}function W(r,a){r&1&&(n(0,"small"),i(1,"Required"),t())}function X(r,a){r&1&&(n(0,"small"),i(1,"Required"),t())}function Y(r,a){if(r&1&&(n(0,"option",18),i(1),t()),r&2){let e=a.$implicit;l("ngValue",e.idDepartment),o(),u(e.name)}}function Z(r,a){r&1&&(n(0,"small"),i(1,"Valid email required"),t())}function ee(r,a){r&1&&(n(0,"small"),i(1,"Required"),t())}function te(r,a){r&1&&(n(0,"small"),i(1,"Required"),t())}function ne(r,a){if(r&1){let e=M();n(0,"form",7),O("ngSubmit",function(){C(e);let $=_();return b($.submit())}),n(1,"section",8)(2,"h3"),g(),n(3,"svg",9),m(4,"circle",10)(5,"path",11),t(),i(6,"Personal Info"),t(),v(),n(7,"div",12)(8,"div",13)(9,"label"),i(10,"First Name "),n(11,"span"),i(12,"*"),t()(),m(13,"input",14),d(14,Q,2,0,"small",5),t(),n(15,"div",13)(16,"label"),i(17,"Last Name "),n(18,"span"),i(19,"*"),t()(),m(20,"input",15),d(21,W,2,0,"small",5),t(),n(22,"div",13)(23,"label"),i(24,"Date of Birth "),n(25,"span"),i(26,"*"),t()(),m(27,"input",16),d(28,X,2,0,"small",5),t(),n(29,"div",13)(30,"label"),i(31,"Department"),t(),n(32,"select",17)(33,"option",18),i(34,"Select department"),t(),d(35,Y,2,2,"option",19),t()()()(),n(36,"section",8)(37,"h3"),g(),n(38,"svg",9),m(39,"path",20),t(),i(40,"Contact Info"),t(),v(),n(41,"div",12)(42,"div",13)(43,"label"),i(44,"Email "),n(45,"span"),i(46,"*"),t()(),m(47,"input",21),d(48,Z,2,0,"small",5),t(),n(49,"div",13)(50,"label"),i(51,"Phone "),n(52,"span"),i(53,"*"),t()(),m(54,"input",22),d(55,ee,2,0,"small",5),t(),n(56,"div",23)(57,"label"),i(58,"Address "),n(59,"span"),i(60,"*"),t()(),m(61,"textarea",24),d(62,te,2,0,"small",5),t()()(),n(63,"footer",25)(64,"a",26),i(65,"Cancel"),t(),n(66,"button",27),i(67),t()()()}if(r&2){let e=_();l("formGroup",e.form),o(13),p("invalid",e.inv("firstName")),o(),l("ngIf",e.inv("firstName")),o(6),p("invalid",e.inv("lastName")),o(),l("ngIf",e.inv("lastName")),o(6),p("invalid",e.inv("dateOfBirth")),o(),l("ngIf",e.inv("dateOfBirth")),o(5),l("ngValue",null),o(2),l("ngForOf",e.depts),o(12),p("invalid",e.inv("email")),o(),l("ngIf",e.inv("email")),o(6),p("invalid",e.inv("phone")),o(),l("ngIf",e.inv("phone")),o(6),p("invalid",e.inv("address")),o(),l("ngIf",e.inv("address")),o(4),l("disabled",e.form.invalid||e.saving),o(),u(e.saving?"Saving...":e.editMode?"Update":"Create")}}var J=class r{fb=c(j);svc=c(V);deptSvc=c(k);route=c(F);router=c(I);form;depts=[];editMode=!1;loading=!0;saving=!1;id;ngOnInit(){this.form=this.fb.group({firstName:["",s.required],lastName:["",s.required],email:["",[s.required,s.email]],phone:["",s.required],dateOfBirth:["",s.required],address:["",s.required],departmentId:[null]}),this.deptSvc.getAll().subscribe({next:e=>this.depts=e});let a=this.route.snapshot.params.id;a&&a!=="new"?(this.editMode=!0,this.id=+a,this.load(this.id)):this.loading=!1}load(a){this.svc.getById(a).subscribe({next:e=>{this.form.patchValue(S(h({},e),{departmentId:e.department?.idDepartment||null})),this.loading=!1},error:()=>this.router.navigate(["/students"])})}inv(a){let e=this.form.get(a);return!!(e&&e.invalid&&e.touched)}submit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.saving=!0;let a=this.form.value,e={firstName:a.firstName,lastName:a.lastName,email:a.email,phone:a.phone,dateOfBirth:a.dateOfBirth,address:a.address};a.departmentId&&(e.department={idDepartment:a.departmentId}),this.editMode&&this.id?(e.idStudent=this.id,this.svc.update(e).subscribe({next:()=>this.router.navigate(["/students"]),error:()=>this.saving=!1})):this.svc.create(e).subscribe({next:()=>this.router.navigate(["/students"]),error:()=>this.saving=!1})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=x({type:r,selectors:[["app-student-form"]],standalone:!0,features:[P],decls:12,vars:4,consts:[[1,"page","animate-fade-in"],["routerLink","/students",1,"back"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","width","20","height","20"],["d","M19 12H5m7 7-7-7 7-7"],[1,"page-header"],[4,"ngIf"],["class","form-card",3,"formGroup","ngSubmit",4,"ngIf"],[1,"form-card",3,"ngSubmit","formGroup"],[1,"section"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5","width","20","height","20"],["cx","12","cy","8","r","5"],["d","M3 21v-2a7 7 0 0 1 7-7h4a7 7 0 0 1 7 7v2"],[1,"grid"],[1,"field"],["formControlName","firstName","placeholder","John",1,"form-control"],["formControlName","lastName","placeholder","Doe",1,"form-control"],["type","date","formControlName","dateOfBirth",1,"form-control"],["formControlName","departmentId",1,"form-control"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["d","M3 8l7.89 5.26a2 2 0 0 0 2.22 0L21 8M5 19h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2z"],["type","email","formControlName","email","placeholder","john@example.com",1,"form-control"],["formControlName","phone","placeholder","+1 234 567 890",1,"form-control"],[1,"field","full"],["formControlName","address","rows","3","placeholder","Full address",1,"form-control"],[1,"form-footer"],["routerLink","/students",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,f){e&1&&(n(0,"div",0)(1,"a",1),g(),n(2,"svg",2),m(3,"path",3),t(),i(4,"Back to Students"),t(),v(),n(5,"header",4)(6,"h1"),i(7),t(),n(8,"p"),i(9),t()(),d(10,K,1,0,"app-loading-spinner",5)(11,ne,68,23,"form",6),t()),e&2&&(o(7),u(f.editMode?"Edit Student":"New Student"),o(2),u(f.editMode?"Update student information":"Add a new student record"),o(),l("ngIf",f.loading),o(),l("ngIf",!f.loading))},dependencies:[N,y,E,U,G,z,H,D,A,q,B,L,R,w,T],styles:[".page[_ngcontent-%COMP%]{padding:var(--space-8);max-width:900px;margin:0 auto}.back[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:var(--space-2);color:var(--text-secondary);font-size:.875rem;margin-bottom:var(--space-4)}.back[_ngcontent-%COMP%]:hover{color:var(--primary-400)}.page-header[_ngcontent-%COMP%]{margin-bottom:var(--space-6)}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:var(--space-1)}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary)}.form-card[_ngcontent-%COMP%]{background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:var(--radius-xl);overflow:hidden}.section[_ngcontent-%COMP%]{padding:var(--space-6);border-bottom:1px solid var(--border-subtle)}.section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-3);font-size:1rem;margin-bottom:var(--space-5)}.section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--primary-400)}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--space-5)}.field.full[_ngcontent-%COMP%]{grid-column:1/-1}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:var(--text-secondary);margin-bottom:var(--space-2)}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--error-500)}.field[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;color:var(--error-500);font-size:.8125rem;margin-top:var(--space-2)}.form-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:var(--space-4);padding:var(--space-5) var(--space-6);background:var(--bg-base)}@media (max-width: 768px){.page[_ngcontent-%COMP%], .section[_ngcontent-%COMP%]{padding:var(--space-4)}.grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-footer[_ngcontent-%COMP%]{flex-direction:column-reverse}.form-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}"]})};export{J as StudentFormComponent};
