import './polyfills.server.mjs';
import{a as k,b as u,c as A,d as G,f as R,g as L,h as q,i as z,j as B,k as H,l as $,m as j,n as U,o as W,q as J}from"./chunk-XIT27GUT.mjs";import{a as N,c as D,d as w,f as T}from"./chunk-B24YV5OD.mjs";import{$ as d,N as a,Na as O,Oa as y,Qa as P,T as m,V as l,X as g,Z as n,_ as t,ca as S,da as E,ea as _,fa as i,fb as I,ga as p,ia as C,ib as F,jb as V,m as s,na as M,o as h,t as x,u as b,v as f,w as v}from"./chunk-ALOC2SIV.mjs";import"./chunk-5XUXGTUW.mjs";function X(r,o){r&1&&d(0,"app-loading-spinner")}function Y(r,o){if(r&1&&(n(0,"option",14),i(1),t()),r&2){let e=o.$implicit;l("ngValue",e.idStudent),a(),C("",e.firstName," ",e.lastName,"")}}function Z(r,o){r&1&&(n(0,"small"),i(1,"Required"),t())}function ee(r,o){if(r&1&&(n(0,"option",14),i(1),t()),r&2){let e=o.$implicit;l("ngValue",e.idCourse),a(),C("",e.name," (",e.code,")")}}function te(r,o){r&1&&(n(0,"small"),i(1,"Required"),t())}function ne(r,o){r&1&&(n(0,"small"),i(1,"Required"),t())}function oe(r,o){if(r&1&&(n(0,"option",24),i(1),t()),r&2){let e=o.$implicit;l("value",e),a(),p(e)}}function ie(r,o){if(r&1){let e=S();n(0,"form",7),E("ngSubmit",function(){x(e);let Q=_();return b(Q.submit())}),n(1,"section",8)(2,"h3"),f(),n(3,"svg",9),d(4,"path",10),t(),i(5,"Enrollment Details"),t(),v(),n(6,"div",11)(7,"div",12)(8,"label"),i(9,"Student "),n(10,"span"),i(11,"*"),t()(),n(12,"select",13)(13,"option",14),i(14,"Select student"),t(),m(15,Y,2,3,"option",15),t(),m(16,Z,2,0,"small",5),t(),n(17,"div",12)(18,"label"),i(19,"Course "),n(20,"span"),i(21,"*"),t()(),n(22,"select",16)(23,"option",14),i(24,"Select course"),t(),m(25,ee,2,3,"option",15),t(),m(26,te,2,0,"small",5),t(),n(27,"div",12)(28,"label"),i(29,"Enrollment Date "),n(30,"span"),i(31,"*"),t()(),d(32,"input",17),m(33,ne,2,0,"small",5),t(),n(34,"div",12)(35,"label"),i(36,"Status "),n(37,"span"),i(38,"*"),t()(),n(39,"select",18),m(40,oe,2,2,"option",19),t()(),n(41,"div",12)(42,"label"),i(43,"Grade (optional)"),t(),d(44,"input",20),t()()(),n(45,"footer",21)(46,"a",22),i(47,"Cancel"),t(),n(48,"button",23),i(49),t()()()}if(r&2){let e=_();l("formGroup",e.form),a(12),g("invalid",e.inv("studentId")),a(),l("ngValue",null),a(2),l("ngForOf",e.students),a(),l("ngIf",e.inv("studentId")),a(6),g("invalid",e.inv("courseId")),a(),l("ngValue",null),a(2),l("ngForOf",e.courses),a(),l("ngIf",e.inv("courseId")),a(6),g("invalid",e.inv("enrollmentDate")),a(),l("ngIf",e.inv("enrollmentDate")),a(7),l("ngForOf",e.statuses),a(8),l("disabled",e.form.invalid||e.saving),a(),p(e.saving?"Saving...":e.editMode?"Update":"Create")}}var K=class r{fb=s(W);svc=s(w);studentSvc=s(N);courseSvc=s(D);route=s(I);router=s(F);form;students=[];courses=[];statuses=["ACTIVE","COMPLETED","DROPPED","FAILED","WITHDRAWN"];editMode=!1;loading=!0;saving=!1;id;ngOnInit(){this.form=this.fb.group({studentId:[null,u.required],courseId:[null,u.required],enrollmentDate:["",u.required],status:["ACTIVE",u.required],grade:[null]}),this.studentSvc.getAll().subscribe({next:e=>this.students=e}),this.courseSvc.getAll().subscribe({next:e=>this.courses=e});let o=this.route.snapshot.params.id;o&&o!=="new"?(this.editMode=!0,this.id=+o,this.load(this.id)):this.loading=!1}load(o){this.svc.getById(o).subscribe({next:e=>{this.form.patchValue({studentId:e.student?.idStudent||null,courseId:e.course?.idCourse||null,enrollmentDate:e.enrollmentDate,status:e.status,grade:e.grade}),this.loading=!1},error:()=>this.router.navigate(["/enrollments"])})}inv(o){let e=this.form.get(o);return!!(e&&e.invalid&&e.touched)}submit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.saving=!0;let o=this.form.value,e={enrollmentDate:o.enrollmentDate,status:o.status,grade:o.grade,student:{idStudent:o.studentId},course:{idCourse:o.courseId}};this.editMode&&this.id?(e.idEnrollment=this.id,this.svc.update(e).subscribe({next:()=>this.router.navigate(["/enrollments"]),error:()=>this.saving=!1})):this.svc.create(e).subscribe({next:()=>this.router.navigate(["/enrollments"]),error:()=>this.saving=!1})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=h({type:r,selectors:[["app-enrollment-form"]],standalone:!0,features:[M],decls:12,vars:4,consts:[[1,"page","animate-fade-in"],["routerLink","/enrollments",1,"back"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","width","20","height","20"],["d","M19 12H5m7 7-7-7 7-7"],[1,"page-header"],[4,"ngIf"],["class","form-card",3,"formGroup","ngSubmit",4,"ngIf"],[1,"form-card",3,"ngSubmit","formGroup"],[1,"section"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5","width","20","height","20"],["d","M9 12h6m-6 4h6m2 5H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5.586a1 1 0 0 1 .707.293l5.414 5.414a1 1 0 0 1 .293.707V19a2 2 0 0 1-2 2z"],[1,"grid"],[1,"field"],["formControlName","studentId",1,"form-control"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["formControlName","courseId",1,"form-control"],["type","date","formControlName","enrollmentDate",1,"form-control"],["formControlName","status",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["type","number","formControlName","grade","min","0","max","100","step","0.1","placeholder","0-100",1,"form-control"],[1,"form-footer"],["routerLink","/enrollments",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"value"]],template:function(e,c){e&1&&(n(0,"div",0)(1,"a",1),f(),n(2,"svg",2),d(3,"path",3),t(),i(4,"Back to Enrollments"),t(),v(),n(5,"header",4)(6,"h1"),i(7),t(),n(8,"p"),i(9),t()(),m(10,X,1,0,"app-loading-spinner",5)(11,ie,50,17,"form",6),t()),e&2&&(a(7),p(c.editMode?"Edit Enrollment":"New Enrollment"),a(2),p(c.editMode?"Update enrollment information":"Enroll a student in a course"),a(),l("ngIf",c.loading),a(),l("ngIf",!c.loading))},dependencies:[P,O,y,J,R,H,$,k,L,B,A,G,U,j,q,z,V,T],styles:[".page[_ngcontent-%COMP%]{padding:var(--space-8);max-width:900px;margin:0 auto}.back[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:var(--space-2);color:var(--text-secondary);font-size:.875rem;margin-bottom:var(--space-4)}.back[_ngcontent-%COMP%]:hover{color:var(--primary-400)}.page-header[_ngcontent-%COMP%]{margin-bottom:var(--space-6)}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:var(--space-1)}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary)}.form-card[_ngcontent-%COMP%]{background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:var(--radius-xl);overflow:hidden}.section[_ngcontent-%COMP%]{padding:var(--space-6)}.section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-3);font-size:1rem;margin-bottom:var(--space-5)}.section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--primary-400)}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--space-5)}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:var(--text-secondary);margin-bottom:var(--space-2)}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--error-500)}.field[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;color:var(--error-500);font-size:.8125rem;margin-top:var(--space-2)}.form-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:var(--space-4);padding:var(--space-5) var(--space-6);background:var(--bg-base)}@media (max-width: 768px){.page[_ngcontent-%COMP%]{padding:var(--space-4)}.grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-footer[_ngcontent-%COMP%]{flex-direction:column-reverse}.form-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}"]})};export{K as EnrollmentFormComponent};
